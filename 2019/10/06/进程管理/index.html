<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>进程管理 | JJW-STORY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="JJW-STORY">
  
  <meta name="description" content="进程管理进程可以理解为程序正在运行的过程，管理的内容主要包括程序什么时候启动，程序运行的整个生命周期需要多少资源，包括需要多少内存资源，运行是需要多少CPU资源，运行结束是需要自己结束还是被其他程序结束的，还有程序运行时我们需要让他结束应该怎么让它结束等等 进程的概念及进程查看进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的 C程序的启动时从main函数开始的，包括Java等，终止">
<meta name="keywords" content="command,进程管理">
<meta property="og:type" content="article">
<meta property="og:title" content="进程管理">
<meta property="og:url" content="https://jjw-story.github.io/2019/10/06/进程管理/index.html">
<meta property="og:site_name" content="JJW-STORY">
<meta property="og:description" content="进程管理进程可以理解为程序正在运行的过程，管理的内容主要包括程序什么时候启动，程序运行的整个生命周期需要多少资源，包括需要多少内存资源，运行是需要多少CPU资源，运行结束是需要自己结束还是被其他程序结束的，还有程序运行时我们需要让他结束应该怎么让它结束等等 进程的概念及进程查看进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的 C程序的启动时从main函数开始的，包括Java等，终止">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-11-02T09:51:14.163Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="进程管理">
<meta name="twitter:description" content="进程管理进程可以理解为程序正在运行的过程，管理的内容主要包括程序什么时候启动，程序运行的整个生命周期需要多少资源，包括需要多少内存资源，运行是需要多少CPU资源，运行结束是需要自己结束还是被其他程序结束的，还有程序运行时我们需要让他结束应该怎么让它结束等等 进程的概念及进程查看进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的 C程序的启动时从main函数开始的，包括Java等，终止">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>
</html>
<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">JJW-STORY</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a  href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        JJW-STORY
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        技术记录
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="JJW-STORY" target="_blank" href="//jjw-story.github.io">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//jjw-story.github.io">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="Weibo" target="_blank" href="/暂不开放">
                            <i class="fa fa-weibo fa-2x"></i></a>
                    
                        <a title="Twitter" target="_blank" href="/暂不开放">
                            <i class="fa fa-twitter fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-进程管理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      进程管理
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/Linux/">Linux</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2019-10-06
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <h1 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h1><p>进程可以理解为程序正在运行的过程，管理的内容主要包括程序什么时候启动，程序运行的整个生命周期需要多少资源，包括需要多少内存资源，运行是需要多少CPU资源，运行结束是需要自己结束还是被其他程序结束的，还有程序运行时我们需要让他结束应该怎么让它结束等等</p>
<h2 id="进程的概念及进程查看"><a href="#进程的概念及进程查看" class="headerlink" title="进程的概念及进程查看"></a>进程的概念及进程查看</h2><p>进程是运行中的程序，从程序开始运行到终止的整个生命周期是可管理的</p>
<p>C程序的启动时从main函数开始的，包括Java等，终止的方式并不唯一，分为正常终止和异常终止：</p>
<ol>
<li>正常终止也分为从main返回，调用exit等方式</li>
<li>异常终止分为调用abort、接收信号等。当程序获取不到资源比如内存、CPU资源等，会调用abort函数来终止程序</li>
</ol>
<h3 id="ps命令"><a href="#ps命令" class="headerlink" title="ps命令"></a>ps命令</h3><p>使用方法：ps [选项]</p>
<p>单独使用ps命令，它只能查看到当前终端既当前shell下面能够查看到的进程状态，并不是真的只有这些进程在运行，如下只查看到两条:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ etc]# ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">27267 pts/0    00:00:00 bash</span><br><span class="line">27342 pts/0    00:00:00 ps</span><br></pre></td></tr></table></figure>

<ul>
<li><p>PID：表示进程在系统中运行的唯一表示，注意进程的名称是可以重复的，但是PID不能重复</p>
</li>
<li><p>TTY：表示执行当前进程的终端，那么当前执行是一个虚拟终端，所以叫 pts/0</p>
</li>
<li><p>TIME：程序的运行时间，此项不具有参考价值，可以不用关注</p>
</li>
<li><p>CMD：命令</p>
</li>
</ul>
<h4 id="ps选项说明"><a href="#ps选项说明" class="headerlink" title="ps选项说明"></a>ps选项说明</h4><ul>
<li><strong>-e</strong>    查看所有的进程，这样我们查出来的会非常多，我们可以通过 more 命令来进行分页查看，具体使用为：ps -e | more，这里主要是通过管道符，将管道符左边的输出传递给more，示例如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@iZm5ehzqow4ijp2ya2g2drZ etc]#  ps -e | more</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">    1 ?        00:00:00 init</span><br><span class="line">    2 ?        00:00:00 kthreadd</span><br><span class="line">    3 ?        00:00:00 migration/0</span><br><span class="line">    4 ?        00:00:01 ksoftirqd/0</span><br><span class="line">    5 ?        00:00:00 stopper/0</span><br><span class="line">    6 ?        00:00:02 watchdog/0</span><br><span class="line">    7 ?        00:01:35 events/0</span><br></pre></td></tr></table></figure>

<p>注意我们看到的1号进程，此进程在CentOS6中叫init，在CentOS7中叫systemd</p>
<ul>
<li><strong>-f</strong>    表示显示全格式，既对进程的信息显示更加完善，一般是结合-e选项来使用，ps -ef | more</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">root         1     0  0 Sep14 ?        00:00:00 /sbin/init</span><br><span class="line">root         2     0  0 Sep14 ?        00:00:00 [kthreadd]</span><br><span class="line">root         3     2  0 Sep14 ?        00:00:00 [migration/0]</span><br><span class="line">root         4     2  0 Sep14 ?        00:00:01 [ksoftirqd/0]</span><br><span class="line">root         5     2  0 Sep14 ?        00:00:00 [stopper/0]</span><br></pre></td></tr></table></figure>

<p>UID表示此进程是哪一个用户来启动的，但是注意，进程启动的用户是可以修改的，所以它的专业名称叫有效用户ID</p>
<p>PPID是父进程，因为我们的程序在启动时都要集成它的父进程的一些信息下来，Linux的第一个进程是1号进程，既init进程</p>
<ul>
<li><strong>-L</strong>    查看更详细的进程情况，既可以查看到当前进程中包含了多少个线程，通过此选项我们可以查看到当前进程运行缓慢是不是因为并发太大及线程太多导致的，一般使用也是结合着-ef，具体：ps -eLf | more</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UID        PID  PPID   LWP  C NLWP STIME TTY          TIME CMD</span><br><span class="line">root         1     0     1  0    1 Sep14 ?        00:00:00 /sbin/init</span><br><span class="line">root         2     0     2  0    1 Sep14 ?        00:00:00 [kthreadd]</span><br><span class="line">root         3     2     3  0    1 Sep14 ?        00:00:00 [migration/0]</span><br><span class="line">root         4     2     4  0    1 Sep14 ?        00:00:01 [ksoftirqd/0]</span><br><span class="line">root         5     2     5  0    1 Sep14 ?        00:00:00 [stopper/0]</span><br></pre></td></tr></table></figure>

<p>LWP表示的既是线程数量</p>
<h3 id="pstree命令"><a href="#pstree命令" class="headerlink" title="pstree命令"></a>pstree命令</h3><p>pstree命令是将进程用树形表示出来，上述ps命令中，我们能查看到进程的父进程，在使用此命令时，我们可以看到一个树形结构的进程图，方便我们查看进程的依属关系，示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@iZm5ehzqow4ijp2ya2g2drZ etc]# pstree | more</span><br><span class="line">init-+-AliYunDun---17*[&#123;AliYunDun&#125;]</span><br><span class="line">     |-AliYunDunUpdate---3*[&#123;AliYunDunUpdat&#125;]</span><br><span class="line">     |-agetty</span><br><span class="line">     |-aliyun-service---2*[&#123;aliyun-service&#125;]</span><br><span class="line">     |-auditd---&#123;auditd&#125;</span><br><span class="line">     |-crond</span><br><span class="line">     |-dhclient</span><br><span class="line">     |-java---28*[&#123;java&#125;]</span><br></pre></td></tr></table></figure>

<h3 id="top命令"><a href="#top命令" class="headerlink" title="top命令"></a>top命令</h3><p>top命令能显示系统的信息及进程信息，类似于Windows的任务管理器，也是一个日常非常实用的命令，可以不带参数，使用具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ etc]# top</span><br><span class="line">top - 17:38:41 up 22 days,  7:54,  2 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">Tasks:  78 total,   1 running,  77 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):  0.3%us,  0.3%sy,  0.0%ni, 99.3%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   1019980k total,   732792k used,   287188k free,   138988k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   230192k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                          </span><br><span class="line"> 1407 root      10 -10  121m  11m 9176 S  0.3  1.2  94:59.64 AliYunDun                                                                                                         </span><br><span class="line">27417 root      20   0 15012 1292 1004 R  0.3  0.1   0:00.01 top                                                                                                               </span><br><span class="line">    1 root      20   0 19228 1508 1232 S  0.0  0.1   0:00.72 init                                                                                                              </span><br><span class="line">    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                                          </span><br><span class="line">    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li><p>top</p>
<p>  up 22 days： 当前系统上一次开机到现在运行的时长</p>
<p>  users：当前系统有两个用户已经登录了</p>
<p>  load average: 0.00, 0.00, 0.00： 平均负载，全都是0.00表示空负载，数值越大负载越高，都是1表示满负载运行，平均负载是一分钟进行一次汇总的结果，第一个数字是1分钟的数据，中间数据时5分钟的数据，最后一个是15分钟的统计数据，此数据是查看系统繁忙程度的指标数据</p>
</li>
<li><p>Tasks:  </p>
<p>  78 tota：系统中有多少个任务正在运行，这里系统将进程表示为任务</p>
<pre><code>1 running,  77 sleeping,   0 stopped,   0 zombie：一个进程在运行中，77个在休眠状态中。。</code></pre></li>
<li><p>Cpu(s):  </p>
<p>  0.3%us： 0.3%的资源用于用户状态的计算</p>
<p>  0.3%sy： 进程的状态交互占用的资源</p>
<p>  99.3%id：空闲的CPU资源</p>
<p>  0.0%wa：磁盘IO占用的资源</p>
</li>
</ul>
<p>Cpu(s)是说统计的是一个整体情况，如果我们是多核的，可以按下数字键1来分别查看每一个CPU的运行状况，再次按下数字1即可恢复成整体模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">top - 17:54:45 up 1 min,  0 users,  load average: 0.52, 0.58, 0.59</span><br><span class="line">Tasks:   4 total,   1 running,   3 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu0  :  5.4 us,  8.0 sy,  0.0 ni, 84.0 id,  0.0 wa,  2.6 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu1  :  2.0 us,  3.0 sy,  0.0 ni, 95.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu2  :  5.6 us, 10.8 sy,  0.0 ni, 83.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu3  :  3.0 us,  3.0 sy,  0.0 ni, 94.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu4  :  4.6 us,  3.0 sy,  0.0 ni, 92.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu5  :  2.3 us,  0.3 sy,  0.0 ni, 97.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu6  :  1.6 us,  2.0 sy,  0.0 ni, 96.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu7  :  1.6 us, 14.8 sy,  0.0 ni, 83.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem : 16670136 total,  9322736 free,  7118048 used,   229352 buff/cache</span><br><span class="line">KiB Swap: 15518328 total, 15430616 free,    87712 used.  9418356 avail Mem</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Mem：</p>
<p>  1019980k total：总共有多少内存</p>
<p>  732792k used：已经使用了的内存</p>
<p>  287188k free：空闲的内存</p>
<p>  138988k buffers：读写缓存使用的内存</p>
</li>
<li><p>Swap：交换分区，当内存不够用的时候，需要使用交换分区的内存</p>
<p>  0k used：这里只需要关注此选项即可，因为在内存占用比较大的时候才会与系统进行交换分区内存，这里有占用说明程序占用内存很大了</p>
</li>
<li><p>进程信息：</p>
<p>  这里的进程信息我们可以看到还显示了每个进程当前的CPU占用率，以及内存占用情况，默认是3秒已刷新，我们还可以修改刷新时间，使用按键s，即可输入你需要的刷新间隔时间，然后回车，注意单位是秒，这样既可以按照你输入的时间间隔来刷新</p>
<p>  进程信息中<strong>PR</strong>表示进程的系统优先级，<strong>NI</strong>表示Nice值，可以理解为此进程占用了多少系统资源，<strong>%CPU</strong>表示进程占用的CPU资源百分比</p>
</li>
</ul>
<h4 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h4><ul>
<li><strong>-p</strong>    使用-p参数然后指定进程id可以只查看指定id的进程信息，使用示例：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# top -p 35</span><br><span class="line">top - 16:33:23 up 29 days,  6:49,  2 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):  0.0%us,  0.0%sy,  0.0%ni,100.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   1019980k total,   758240k used,   261740k free,   139084k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   239196k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line">   35 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd</span><br></pre></td></tr></table></figure>

<h2 id="进程的优先级调整"><a href="#进程的优先级调整" class="headerlink" title="进程的优先级调整"></a>进程的优先级调整</h2><p>进程的优先级我们可以通过查看进程的信息来具体查看，进程信息的NI选项就表示进程的优先级，NI的值在 -20 ~ 19 之间，值越小，优先级越高，抢占资源就越多，一般我们启动的程序默认的优先级是0</p>
<h3 id="使用nice命令修改启动进程的优先级"><a href="#使用nice命令修改启动进程的优先级" class="headerlink" title="使用nice命令修改启动进程的优先级"></a>使用nice命令修改启动进程的优先级</h3><p>我们首先启动一个程序，查看它的进程信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 第一个终端启动此自定义进程</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# ./test.sh</span><br><span class="line">2946</span><br><span class="line"></span><br><span class="line"># 重新打开一个终端，查看此进程的信息</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# top -p 2946</span><br><span class="line">top - 17:14:15 up 29 days,  7:29,  3 users,  load average: 0.89, 0.85, 0.55</span><br><span class="line">Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):100.0%us,  0.0%sy,  0.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   1019980k total,   760396k used,   259584k free,   139088k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   239332k cached</span><br><span class="line"></span><br><span class="line">PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"> 2946 root      20   0  103m 1332 1152 R 99.9  0.1   0:53.76 test.sh</span><br></pre></td></tr></table></figure>

<p>我们看到此进程的NI值为0，CPU的占用率达到了100%，因为我们这个程序一直在循环执行中，然后我们停止此程序，然后使用nice命令指定优先级</p>
<p>nice命令使用方法：nice -n [优先级值] ./应用程序</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 使用第一个终端启动自定义的应用程序并指定进程优先级为15</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# nice -n 15 ./test.sh</span><br><span class="line">2953</span><br><span class="line"></span><br><span class="line"># 使用第二个终端查看此进程信息</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# top -p 2953</span><br><span class="line">top - 17:12:54 up 29 days,  7:28,  3 users,  load average: 0.92, 0.84, 0.52</span><br><span class="line">Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):  0.0%us,  0.0%sy,100.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   1019980k total,   760396k used,   259584k free,   139088k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   239332k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"> 2953 root      35  15  103m 1332 1152 R 99.6  0.1   1:42.75 test.sh</span><br></pre></td></tr></table></figure>

<p>通过更改程序的优先级来启动程序，我们发现更改后的此进程NI值就变成了我们设置的值，并且很明显的区别就是CPU占用率，我们将优先级值调大之后，CPU占用率在0.0% - 0.3%摆动，表示资源占用急剧下降，所以我们指定程序的优先级是很有效果的一个操作</p>
<h3 id="使用renice命令修改进程的优先级"><a href="#使用renice命令修改进程的优先级" class="headerlink" title="使用renice命令修改进程的优先级"></a>使用renice命令修改进程的优先级</h3><p>nice命令有一个问题，我们一般程序在运行中不会终止，上述更改优先级需要将程序停止然后重新指定优先级后启动，这个问题怎么解决呢？ 使用renice命令就可以解决，可以在程序运行中直接修改，无需重启</p>
<p>使用方法：renice -n [优先级值] ./应用程序</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 第一个终端启动此自定义进程</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# ./test.sh</span><br><span class="line">2966</span><br><span class="line"></span><br><span class="line"># 使用第二个终端查看此进程的信息</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# top -p 2966</span><br><span class="line">...</span><br><span class="line">Cpu(s):100.0%us,  0.0%sy,  0.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"> 2966 root      20   0  103m 1332 1152 R 99.7  0.1   0:47.87 test.sh</span><br><span class="line"></span><br><span class="line"> # 使用第三个终端使用renice修改此进程的优先级值为18</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# renice -n 18 2966</span><br><span class="line">2966: old priority 0, new priority 18</span><br><span class="line"></span><br><span class="line"># 切换回第二个终端查看此进程信息，我们发现进程的优先级已经被修改，且程序并没有停止</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# top -p 2966</span><br><span class="line">...</span><br><span class="line">Cpu(s):  0.0%us,  0.0%sy,100.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"> 2966 root      38  18  103m 1332 1152 R 99.6  0.1   5:07.68 test.sh</span><br></pre></td></tr></table></figure>

<h2 id="进程的启动前台后台切换"><a href="#进程的启动前台后台切换" class="headerlink" title="进程的启动前台后台切换"></a>进程的启动前台后台切换</h2><h3 id="程序后台启动"><a href="#程序后台启动" class="headerlink" title="程序后台启动"></a>程序后台启动</h3><p>我们上述启动程序发现程序一直在终端显示，无法输入其他命令，此终端不能进行其他操作，这种启动的方式叫做前台启动，后台启动就是程序是后台运行的，不影响我们在终端进行操作</p>
<p>后台启动程序的方式是在启动程序命令后 加 <strong>&amp;</strong> ，使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# ./test.sh &amp;</span><br><span class="line">[3] 3019</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# 3019</span><br><span class="line">ls</span><br><span class="line">test.sh</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# top -p 3019</span><br><span class="line">...</span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"> 3019 root      20   0  103m 1332 1152 R 49.9  0.1   0:14.74 test.sh</span><br></pre></td></tr></table></figure>

<p>通过示例我们发现，启动程序后终端返回了程序的进程ID，然后我们就可以在此终端上进行任意其他操作</p>
<h3 id="后台运行程序切换回前台运行"><a href="#后台运行程序切换回前台运行" class="headerlink" title="后台运行程序切换回前台运行"></a>后台运行程序切换回前台运行</h3><p>有时候我们需要将后台运行的程序切换回前台运行，可以使用 jobs命令查询出所有的后台程序，然后根据后台运行编号使用fg命令切换回来，使用如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# jobs</span><br><span class="line">[3]+  Running                 ./test.sh &amp;</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# fg 3</span><br><span class="line">./test.sh</span><br></pre></td></tr></table></figure>

<p>我们发现程序就恢复前台运行了，此时可以通过 CTRL + C 来终止此程序</p>
<h3 id="前台运行程序切换到后台运行"><a href="#前台运行程序切换到后台运行" class="headerlink" title="前台运行程序切换到后台运行"></a>前台运行程序切换到后台运行</h3><p>使用 CTRL + Z 可以将前台运行程序切换为后台运行，但是使用此命令切换到后台运行，程序就不是运行的状态了，而是一个暂停运行的状态，它保存在了内存中</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 首先前台启动进程，然后使用 CTRL + Z 将程序转为后台运行，并且提示你程序为Stopped状态，既停止运行的状态</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# ./test.sh</span><br><span class="line">3043</span><br><span class="line">^Z</span><br><span class="line">[4]+  Stopped                 ./test.sh</span><br></pre></td></tr></table></figure>

<p>上述示例我们发现程序进入后台运行但是是停止状态，我们需要让程序继续运行怎么办？使用jobs命令，然后使用 fg 将程序切换为前台运行或者使用 bg 将程序切换为后台运行</p>
<p>切换为前台运行我们上面已经有过示例了，现在我们示例切换为后台运行，完整示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 前台运行程序然后切换为后台暂停运行</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# ./test.sh</span><br><span class="line">3050</span><br><span class="line">^Z</span><br><span class="line">[5]+  Stopped                 ./test.sh</span><br><span class="line"></span><br><span class="line"># 将程序切换为后台运行</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# jobs</span><br><span class="line">[5]+  Stopped                 ./test.sh</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# bg 5</span><br><span class="line">[5]+ ./test.sh &amp;</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ home]# jobs</span><br><span class="line">[5]   Running                 ./test.sh</span><br></pre></td></tr></table></figure>

<p>上述后，我们发现程序就为后台运行了</p>
<h2 id="进程的通信方式与信号"><a href="#进程的通信方式与信号" class="headerlink" title="进程的通信方式与信号"></a>进程的通信方式与信号</h2><p>进程之间的通信就是两个进程之间可以有一些消息进行交互，还有就是两个进程之间可以互相进行控制。进程通信有很多种的方式，比如管道，信号，这里我们主要学习信号</p>
<p>信号：终端用户通过快捷键或者命令来输入信号，通过信号的机制可以让程序停止运行，经常使用的有 CTRL + C、kill等</p>
<h3 id="kill命令"><a href="#kill命令" class="headerlink" title="kill命令"></a>kill命令</h3><p>我们可以使用kill命令的 <strong>-l</strong> 参数来查看我们系统支持的所有信号，示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# kill -l</span><br><span class="line"> 1) SIGHUP	 2) SIGINT	 3) SIGQUIT	 4) SIGILL	 5) SIGTRAP</span><br><span class="line"> 6) SIGABRT	 7) SIGBUS	 8) SIGFPE	 9) SIGKILL	10) SIGUSR1</span><br><span class="line">11) SIGSEGV	12) SIGUSR2	13) SIGPIPE	14) SIGALRM	15) SIGTERM</span><br><span class="line">16) SIGSTKFLT	17) SIGCHLD	18) SIGCONT	19) SIGSTOP	20) SIGTSTP</span><br><span class="line">21) SIGTTIN	22) SIGTTOU	23) SIGURG	24) SIGXCPU	25) SIGXFSZ</span><br><span class="line">26) SIGVTALRM	27) SIGPROF	28) SIGWINCH	29) SIGIO	30) SIGPWR</span><br><span class="line">31) SIGSYS	34) SIGRTMIN	35) SIGRTMIN+1	36) SIGRTMIN+2	37) SIGRTMIN+3</span><br><span class="line">38) SIGRTMIN+4	39) SIGRTMIN+5	40) SIGRTMIN+6	41) SIGRTMIN+7	42) SIGRTMIN+8</span><br><span class="line">43) SIGRTMIN+9	44) SIGRTMIN+10	45) SIGRTMIN+11	46) SIGRTMIN+12	47) SIGRTMIN+13</span><br><span class="line">48) SIGRTMIN+14	49) SIGRTMIN+15	50) SIGRTMAX-14	51) SIGRTMAX-13	52) SIGRTMAX-12</span><br><span class="line">53) SIGRTMAX-11	54) SIGRTMAX-10	55) SIGRTMAX-9	56) SIGRTMAX-8	57) SIGRTMAX-7</span><br><span class="line">58) SIGRTMAX-6	59) SIGRTMAX-5	60) SIGRTMAX-4	61) SIGRTMAX-3	62) SIGRTMAX-2</span><br><span class="line">63) SIGRTMAX-1	64) SIGRTMAX</span><br></pre></td></tr></table></figure>

<p>以上就是我们系统中所有的信号，平时我们使用的CTRL + C对应的就是2号信号，SIGINT</p>
<p>kill命令具体使用方法：kill [-信号编号] 进程ID</p>
<p>比如我们平时使用的更多的是 <strong>kill -9</strong> 9号命令，它是用于强制停止进程，直接杀掉，一般我们在生产中直接使用 kill 命令来结束程序，可以达到优雅下线的效果</p>
<h2 id="守护进程"><a href="#守护进程" class="headerlink" title="守护进程"></a>守护进程</h2><p>很多时候我们希望我们有些进程在系统启动的时候就启动，或者有些我们在终端启动的进程在关闭终端之后还继续运行，Linux提供了实现这种需求的方法，就是使用守护进程，英文叫 daemon，就是精灵的意思，守护进程实现的就是我们不需要使用终端就可以把进程启动起来，另外启动的时候它的输出也会打印出来，并且这个程序使用的目录是根目录，避免占用其他一些移动硬盘的目录，导致此移动硬盘无法卸载的情况</p>
<h3 id="nohup启动进程"><a href="#nohup启动进程" class="headerlink" title="nohup启动进程"></a>nohup启动进程</h3><p>在讲守护进程之前我们先讲另外一个进程，叫nohup启动进程，以此来对比守护进程</p>
<p>nohup启动进程会使进程忽略掉 <strong>hangup</strong> 挂起信号，使用此进程我们可以实现守护进程的效果，比如关掉终端之后进程还可以继续运行，但它还是有一些不同，首先这里示例一下使用nohup进程的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 首先我们使用第一个终端然后运行 tail 进程</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# tail -1000f /balyu/logs/platformrun.log </span><br><span class="line">2019-10-19 01:02:12.606 [http-nio-80-exec-16] INFO  com.sparrow.portal.IndexController - access index...</span><br><span class="line">2019-10-19 01:18:06.548 [http-nio-80-exec-18] INFO  com.sparrow.manage.monitor.AccessMonitor - 123.126.113.160</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"># 然后打开第二个终端查看此进程 这里是可以查看到的</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     12218 12129  0 13:46 pts/2    00:00:00 tail -1000f /balyu/logs/platformrun.log</span><br><span class="line">root     12237 12221  0 13:47 pts/3    00:00:00 grep tail</span><br><span class="line"></span><br><span class="line"># 然后第三步是直接关闭终端，不退出tail直接关闭终端窗口</span><br><span class="line"># 然后第四步我们继续到另一个终端查看此进程   -&gt; 发现tail进程也不存在了</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     12241 12221  0 13:49 pts/3    00:00:00 grep tail</span><br></pre></td></tr></table></figure>

<p>下面示例使用nohup来是进程在终端关闭后继续运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 第一步使用nohup启动tail进程，启动后提示将此进程的输出比如tail的查看内容输出放在了 nohup.out 文件下</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# nohup tail - 100f /balyu/logs/platformrun.log  </span><br><span class="line">nohup: ignoring input and appending output to `nohup.out&apos;</span><br><span class="line"></span><br><span class="line"># 第二步启动另外一个终端查看此进程，这里我们查看到此进程的父进程是 pts/3</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     12251 12221  0 13:54 pts/3    00:00:00 tail -100f /balyu/logs/platformrun.log</span><br><span class="line">root     12270 12254  0 13:55 pts/2    00:00:00 grep tail</span><br><span class="line"></span><br><span class="line"># 第三步关闭此终端，然后使用另一个终端查看tail进程，我们发现进程还在存活，但是父进程变成了?，这是因为我们的进程在终端关闭之后此进程就成了孤儿进程，孤儿进程一定要被其它进程所收留，那么这里它就被 1 号进程所收留，这里显示了一个 ?，但其实是 1 号进程，init进程</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     12251     1  0 13:54 ?        00:00:00 tail -100f /balyu/logs/platformrun.log</span><br><span class="line">root     12272 12254  0 13:56 pts/2    00:00:00 grep tail</span><br></pre></td></tr></table></figure>

<p>以上就是nohup的使用示例，这里我们发现虽然可以将进程一直运行，但是启动程序的时候还是要通过终端启动，还有一个特点就是我们的进程输出会放在我们执行命令的当前文件夹下的nohup.out文件，它会占用我们当前磁盘的空间，name我们可不可以像windows一样，设置开机自启动呢？并且有一个合理的日志文件或者输出内容的文件所在的位置呢？请看下面的内容</p>
<h3 id="screen命令"><a href="#screen命令" class="headerlink" title="screen命令"></a>screen命令</h3><p>Screen是一款由GNU计划开发的用于命令行终端切换的自由软件。用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。GNU Screen可以看作是窗口管理器的命令行界面版本。它提供了统一的管理多个会话的界面和相应的功能</p>
<p>在Screen环境下，所有的会话都独立的运行，并拥有各自的编号、输入、输出和窗口缓存。用户可以通过快捷键在不同的窗口下切换，并可以自由的重定向各个窗口的输入和输出</p>
<p>总的来说个人理解就是使用screen启动的程序我们在退出screen之后，程序还会继续运行，退出终端也会如此，所以直接将启动的程序作为了守护进程</p>
<p>使用方法：</p>
<ol>
<li><p>使用 <strong>screen</strong> 命令直接进入screen环境</p>
</li>
<li><p>操作完成后或者启动程序完成后，使用 <strong>CTRL + A D</strong>，退出（detached）screen环境</p>
</li>
<li><p>我们可以使用 <strong>screen -ls</strong> 查看所有screen的会话</p>
</li>
<li><p>可以使用 <strong>screen -r sessionid</strong> 恢复会话，注意这里的sessionid是上述使用-ls查询出来的信息</p>
</li>
</ol>
<p>注意：我们可以在screen模式下结束我们的进程，退出此环境使用 <strong>exit</strong> 退出此环境</p>
<p>以下是使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"># 1.首先使用screen命令进入此环境</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen</span><br><span class="line">-bash: screen: command not found</span><br><span class="line"></span><br><span class="line"># 2.这里提示找不到这个命令，是因为我们没有安装，需要使用yum命令进行安装</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# yum install screen</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Setting up Install Process</span><br><span class="line">...</span><br><span class="line">Installed:</span><br><span class="line">  screen.x86_64 0:4.0.3-19.el6</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line"># 3.安装成功后再次使用此命令进入Screen环境，我们发现直接就进入了此环境，并没有任何提示和不一样的地方</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen</span><br><span class="line"></span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# </span><br><span class="line"></span><br><span class="line"># 4.再此环境下执行命令，还是之前使用的tail命令来让它后台运行</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# tail -1000f  /balyu/logs/platformrun.log </span><br><span class="line">2019-10-26 00:15:58.351 [http-nio-80-exec-9] INFO  com.sparrow.portal.IndexController - access index...</span><br><span class="line">2019-10-26 00:51:58.660 [http-nio-80-exec-7] ERROR org.apache.catalina.core.ContainerBase.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]</span><br><span class="line">org.apache.catalina.connector.ClientAbortException: java.io.IOException: Connection reset by peer</span><br><span class="line"></span><br><span class="line"># 5.使用另外一个客户端，查看此启动的进程，我们发现实可以查询到的</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     20513 20484  0 12:02 pts/1    00:00:00 tail -1000f /balyu/logs/platformrun.log</span><br><span class="line">root     20532 20516  0 12:04 pts/3    00:00:00 grep tail</span><br><span class="line"></span><br><span class="line"># 6.我们使用CTRL + A D退出screen环境，退出后发现终端并没有什么变化</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen</span><br><span class="line">[detached]</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# </span><br><span class="line"></span><br><span class="line"># 7.我们再次用第二个客户端查看在screen环境中启动的tail进程发现是可以查询到的，即使将第一个终端直接关闭掉，也是可以查询到此进程</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# ps -ef | grep tail</span><br><span class="line">root     20513 20484  0 12:02 pts/1    00:00:00 tail -1000f /balyu/logs/platformrun.log</span><br><span class="line">root     20538 20516  0 12:09 pts/3    00:00:00 grep tail</span><br><span class="line"></span><br><span class="line"># 8.使用第二个终端查询当前系统上运行的screen环境， screen -ls 命令，查询发现启动的有一个，并且sessionid是20483    </span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen -ls</span><br><span class="line">There is a screen on:</span><br><span class="line">	20483.pts-0.iZm5ehzqow4ijp2ya2g2drZ	(Detached)</span><br><span class="line">1 Socket in /var/run/screen/S-root.</span><br><span class="line"></span><br><span class="line"># 9.使用 screen -r sessionid恢复此screen环境，发现是恢复了的</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen -r 20483</span><br><span class="line"></span><br><span class="line">        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:726)</span><br><span class="line">        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)</span><br><span class="line">        ... </span><br><span class="line"></span><br><span class="line"># 10.使用CTRL + C 退出此环境下前台运行的程序（tail 程序），然后使用exit退出screen环境</span><br><span class="line">... 这里不做演示</span><br><span class="line"></span><br><span class="line"># 11.再次使用screen -ls 查询运行的screen环境，发现已经查询不到了，因为我们已经退出了</span><br><span class="line">[root@iZm5ehzqow4ijp2ya2g2drZ ~]# screen -ls</span><br><span class="line">No Sockets found in /var/run/screen/S-root.</span><br></pre></td></tr></table></figure>

<h2 id="系统日志"><a href="#系统日志" class="headerlink" title="系统日志"></a>系统日志</h2><p>这里只是一个补充说明，我们可以进入 /var/log 文件夹，这里有大量的日志文件，这些文件叫做系统日志，我们系统运行的状态都记录在这些文件中，重点关注以下文件就行：</p>
<ol>
<li><p>messages文件，系统的常规日志，也可以理解为当前系统运行实时产生的日志</p>
</li>
<li><p>dmesg文件，内核日志信息，内核日志一般在我们启动系统的时候启动内核所打印出来的日志，一般我们在系统启动时可能查看的不够详细，这样我们就可以直接查看此文件来详细查看内核启动运行的一些日志信息</p>
</li>
<li><p>secure文件，这个文件是我们系统的安全日志，此文件可以查看系统有没有产生一些安全的问题</p>
</li>
<li><p>cron文件，这个日志是我们系统执行计划任务，定时任务等产生的日志，查看这种任务的日志可以在此文件中查看</p>
</li>
</ol>
<h2 id="服务管理工具"><a href="#服务管理工具" class="headerlink" title="服务管理工具"></a>服务管理工具</h2><p>这里服务指的是提供常见功能的守护进程，是系统本身所提供的服务。服务管理工具说的是我们之前在<strong>网络管理和配置文件</strong>章节讲述过，有两种，CentOS7以前的版本是用的是service工具，之后默认使用的是systemctl工具，但是我们可以切换回service工具来管理</p>
<p>我们之前讲述过service的基本启动脚本在 <strong>/etc/init.d</strong> 文件夹中，这里有我们service管理工具所管理的所有服务，每个服务都有一个文件，此文件中便是服务的启动关闭重启等等的操作的命令脚本，这些脚本也可以我们自己来编写，就比如之前我们操作过的网卡服务，network文件中便有一堆关于操作网卡的脚本，每个操作我们可以理解为一个函数，函数中又具体的后台的逻辑。我们可以看到，service管理的服务脚本都很复杂。而systemctl管理工具基本的脚本在 <strong>/usr/lib/systemd/system</strong> 文件夹下，里面也是各种文件，文件所管理的就是服务，比如我们打开sshd.service文件，这个里面就是封装的sshd服务的一些操作脚本，我们明显可以看到这里的脚本比service管理的服务脚本要简单很多，这是因为脚本中具体的逻辑都已经有systemctl来管理了，不需要我们手动自己来写这些复杂的脚本，所有相对看着比较简单，我们在Linux系统的迭代中，会逐渐的将所有的service管理的服务都交给systenctl来管理。</p>
<p>之前我们说过service管理的服务都有级别，分为6个级别，这6个级别分别代表程序在哪个级别是启动的，在哪个级别的关闭的，我们可以通过service提供的chkconfig命令来查看及修改服务在各种级别运行的状态，而systemctl管理工具不是用过数字来代表启动级别了，而是直接通过英语单词来代表</p>
<p>systemctl管理工具怎么操作服务，我们列举一下常见的操作：</p>
<p>start、stop、restart、reload、enable、disable、status</p>
<p>使用的方法就是：<strong>systemctl 操作命令 服务名称</strong>，例如：systemctl start sshd.service</p>
<p>具体有哪些服务呢？我们可以直接查看 <strong>/usr/lib/systemd/system</strong> 文件夹，里面的内容中有很多扩展名为 <strong>.service</strong> 和 <strong>.target</strong> 的文件，.service的文件就是我们管理的服务，我们就可以通过systemctl命令来操作这些服务，这些.target的文件，表示的就是服务表示的就是不同的级别，runleavel0.target 到 runleavel6.target 就表示我们之前描述的 0 - 6 的系统级别，我们可以通过命令 <strong>ls -l runleavel*.target</strong> 来查看这些文件的具体映射，这些查看出来的文件就映射到了具体的英文单词表示的级别</p>
<p>我们还可以通过 <strong>systemctl get-default</strong> 来查看我们当前系统的默认级别，字符级别还是图形界面级别。还可以通过 <strong>systemctl set-default 级别英文单词表示</strong> 来修改我们设置的默认级别，这样在下次启动系统的时候就切换了默认的级别，例如： systemctl set-default multy-user.target 就将默认的启动级别就切换成多用户的启动级别了，也就是字符界面级别</p>
<p>以上具体可以查看 网络管理和配置文件 章节</p>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2019年11月02日 17:51</p>
        <p>原始链接： <a class="post-url" href="/2019/10/06/进程管理/" title="进程管理">https://jjw-story.github.io/2019/10/06/进程管理/</a></p>
        <footer>
            <a href="https://jjw-story.github.io">
                <img src="/images/logo.png" alt="JJW">
                JJW
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        请我吃糖~
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://jjw-story.github.io/2019/10/06/进程管理/&title=《进程管理》 — JJW-STORY&pic=/images/blogs/shell.jpg" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://jjw-story.github.io/2019/10/06/进程管理/&title=《进程管理》 — JJW-STORY&source=" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jjw-story.github.io/2019/10/06/进程管理/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《进程管理》 — JJW-STORY&url=https://jjw-story.github.io/2019/10/06/进程管理/&via=https://jjw-story.github.io" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://jjw-story.github.io/2019/10/06/进程管理/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://jjw-story.github.io/2019/10/06/进程管理/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/command/" class="color3">command</a>
      
    <a href="/tags/进程管理/" class="color5">进程管理</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#进程管理"><span class="post-toc-text">进程管理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进程的概念及进程查看"><span class="post-toc-text">进程的概念及进程查看</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ps命令"><span class="post-toc-text">ps命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ps选项说明"><span class="post-toc-text">ps选项说明</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pstree命令"><span class="post-toc-text">pstree命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#top命令"><span class="post-toc-text">top命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参数说明"><span class="post-toc-text">参数说明</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进程的优先级调整"><span class="post-toc-text">进程的优先级调整</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用nice命令修改启动进程的优先级"><span class="post-toc-text">使用nice命令修改启动进程的优先级</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用renice命令修改进程的优先级"><span class="post-toc-text">使用renice命令修改进程的优先级</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进程的启动前台后台切换"><span class="post-toc-text">进程的启动前台后台切换</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#程序后台启动"><span class="post-toc-text">程序后台启动</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#后台运行程序切换回前台运行"><span class="post-toc-text">后台运行程序切换回前台运行</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前台运行程序切换到后台运行"><span class="post-toc-text">前台运行程序切换到后台运行</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进程的通信方式与信号"><span class="post-toc-text">进程的通信方式与信号</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#kill命令"><span class="post-toc-text">kill命令</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#守护进程"><span class="post-toc-text">守护进程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#nohup启动进程"><span class="post-toc-text">nohup启动进程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#screen命令"><span class="post-toc-text">screen命令</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#系统日志"><span class="post-toc-text">系统日志</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#服务管理工具"><span class="post-toc-text">服务管理工具</span></a></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2019/10/20/Elasticsearch核心技术/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          Elasticsearch核心技术
        
      </span>
    </a>
  
  
    <a href="/2019/09/03/网络故障排除命令/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">网络故障排除命令</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2019 JJW<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "https://jjw-story.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/IDEA/">IDEA</a><a class="category-link" href="/categories/Linux/">Linux</a><a class="category-link" href="/categories/Python/">Python</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/Django/" style="font-size: 13.33px;">Django</a> <a href="/tags/Elasticsearch核心技术/" style="font-size: 10px;">Elasticsearch核心技术</a> <a href="/tags/IDEA/" style="font-size: 10px;">IDEA</a> <a href="/tags/Python/" style="font-size: 16.67px;">Python</a> <a href="/tags/Python基础/" style="font-size: 10px;">Python基础</a> <a href="/tags/command/" style="font-size: 20px;">command</a> <a href="/tags/overview/" style="font-size: 10px;">overview</a> <a href="/tags/su-sudo/" style="font-size: 10px;">su-sudo</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/内存与磁盘管理/" style="font-size: 10px;">内存与磁盘管理</a> <a href="/tags/基础入门/" style="font-size: 10px;">基础入门</a> <a href="/tags/帮助命令/" style="font-size: 10px;">帮助命令</a> <a href="/tags/打包压缩与解压缩/" style="font-size: 10px;">打包压缩与解压缩</a> <a href="/tags/文件及目录权限/" style="font-size: 10px;">文件及目录权限</a> <a href="/tags/文件查看命令/" style="font-size: 10px;">文件查看命令</a> <a href="/tags/文件管理命令/" style="font-size: 10px;">文件管理命令</a> <a href="/tags/文本查看命令/" style="font-size: 10px;">文本查看命令</a> <a href="/tags/用户和权限管理/" style="font-size: 10px;">用户和权限管理</a> <a href="/tags/网络管理/" style="font-size: 16.67px;">网络管理</a> <a href="/tags/软件包管理器和内核升级/" style="font-size: 10px;">软件包管理器和内核升级</a> <a href="/tags/进程管理/" style="font-size: 10px;">进程管理</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a  href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/Django/" style="font-size: 13.33px;">Django</a> <a href="/tags/Elasticsearch核心技术/" style="font-size: 10px;">Elasticsearch核心技术</a> <a href="/tags/IDEA/" style="font-size: 10px;">IDEA</a> <a href="/tags/Python/" style="font-size: 16.67px;">Python</a> <a href="/tags/Python基础/" style="font-size: 10px;">Python基础</a> <a href="/tags/command/" style="font-size: 20px;">command</a> <a href="/tags/overview/" style="font-size: 10px;">overview</a> <a href="/tags/su-sudo/" style="font-size: 10px;">su-sudo</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/内存与磁盘管理/" style="font-size: 10px;">内存与磁盘管理</a> <a href="/tags/基础入门/" style="font-size: 10px;">基础入门</a> <a href="/tags/帮助命令/" style="font-size: 10px;">帮助命令</a> <a href="/tags/打包压缩与解压缩/" style="font-size: 10px;">打包压缩与解压缩</a> <a href="/tags/文件及目录权限/" style="font-size: 10px;">文件及目录权限</a> <a href="/tags/文件查看命令/" style="font-size: 10px;">文件查看命令</a> <a href="/tags/文件管理命令/" style="font-size: 10px;">文件管理命令</a> <a href="/tags/文本查看命令/" style="font-size: 10px;">文本查看命令</a> <a href="/tags/用户和权限管理/" style="font-size: 10px;">用户和权限管理</a> <a href="/tags/网络管理/" style="font-size: 16.67px;">网络管理</a> <a href="/tags/软件包管理器和内核升级/" style="font-size: 10px;">软件包管理器和内核升级</a> <a href="/tags/进程管理/" style="font-size: 10px;">进程管理</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
</body>
</html>